<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Page</title>
  <link rel="stylesheet" href="hw3a.css">
</head>
<body>
  <header>
    <h1 id='title'>David's Dogs</h1>
  </header>
  
  <main>
    <div id="menu-container">
    </div>
      <input type="text" id="menu-input"><button id="add-to-cart-button">Add to Cart</button>
    <h1 id='cart-header'>My Cart:</h1>
    <div id="cart"></div>
    <button id="checkout-button">Checkout</button>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Step 1 & 2: Create and populate menu grid
      const menu = {
        Hotdogs: 4.00,
        Fries: 3.50,
        Soda: 1.50,
        Sauerkraut: 1.00
      }
      const menuContainer = document.querySelector('#menu-container');
      for(let itemName in menu) {
        // Use for..in for objects, for..of for iterables/arrays.
        let itemNameDiv = document.createElement('div');
        itemNameDiv.textContent = itemName;
        itemNameDiv.className = 'menu-cell';
        let itemCostDiv = document.createElement('div');
        itemCostDiv.textContent = '$' + menu[itemName].toFixed(2);
        itemCostDiv.className = 'menu-cell';
        menuContainer.appendChild(itemNameDiv);
        menuContainer.appendChild(itemCostDiv);
      }

      // Step 3 & 4: Implement "add to cart" button functionality
      let cart = {
        Hotdogs: 0,
        Fries: 0,
        Soda: 0,
        Sauerkraut: 0
      }
      const addToCartButton = document.querySelector('#add-to-cart-button');
      const cartDiv = document.querySelector('#cart');
      addToCartButton.addEventListener('click', event => {
        event.preventDefault(); // Stop button from default submission (necessary if <form> is added)
        let menuInputTextLower = document.querySelector('#menu-input').value.toLowerCase();
        const menuItems = Object.keys(menu);
        let menuMatches = menuItems.filter(x => x.toLowerCase() === menuInputTextLower);
        if (menuMatches.length === 1) {
            const firstChar = menuInputTextLower.charAt(0).toUpperCase()
            const capitalizedMenuInputText = firstChar + menuInputTextLower.slice(1);
            cart[capitalizedMenuInputText] += 1;
            if (cart[capitalizedMenuInputText] === 1) {
                // This is the first item of that kind added to the cart. 
                // Create a new row for it in the cart.
                let itemNameDiv = document.createElement('div');
                itemNameDiv.textContent = capitalizedMenuInputText;
                itemNameDiv.className = "menu-cell";
                let itemQuantityDiv = document.createElement('div');
                itemQuantityDiv.textContent = 1;
                itemQuantityDiv.className = "menu-cell";
                itemQuantityDiv.id = capitalizedMenuInputText;
                cartDiv.appendChild(itemNameDiv);
                cartDiv.appendChild(itemQuantityDiv);
            }
            else {
                // Increment the number of that item in cart.
                let itemQuantityDiv = document.querySelector('#' + capitalizedMenuInputText);
                itemQuantityDiv.textContent = Number(itemQuantityDiv.textContent) + 1;
            }
        }
      });

      // Step 5: Implement "Checkout" button functionality
      checkoutButton = document.querySelector('#checkout-button');
      checkoutButton.addEventListener('click', event => {
        event.preventDefault();
        let outputString = "";
        let runningTotal = 0;
        for(let item in cart) {
            if (cart[item] === 0) continue;
            let extraSpaces = " ".repeat(18 - item.length);
            let lineTotal = cart[item] * menu[item];
            outputString += item + ": " + extraSpaces + "$" + lineTotal.toFixed(2) + "\n";
            runningTotal += cart[item] * menu[item];
        }
        outputString += "Total: " + " ".repeat(18 - 7) + "$" + runningTotal.toFixed(2);
        alert(outputString);
        Object.keys(cart).forEach(item => cart[item] = 0);
        cartDiv.textContent = "";
      })
    });
  </script>
</body>
</html>